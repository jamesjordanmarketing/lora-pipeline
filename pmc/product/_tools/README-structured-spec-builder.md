# Progressive Structured Specification Builder

## Overview

This system transforms **unstructured technical specifications** into **highly structured, progressive specifications** where each section explicitly builds upon previous sections with no redundancy.

### Key Features

- **Progressive Building**: Each section references specific components, APIs, and interfaces from previous sections
- **No Redundancy**: Functionality is never duplicated - always extended or enhanced
- **Explicit Integration**: Cross-section references use exact component names and IDs
- **Wireframe-Level Detail**: UI specifications are detailed enough for complete wireframe creation
- **Automatic Sectioning**: AI determines optimal section breakdown based on content

---

## Files in This System

### 1. Template File
**Path**: `pmc/product/_prompt_engineering/04c-build-structured-with-wirframe-spec_v1.md`

This is the master template that instructs the AI how to transform unstructured specs into progressive structured specs.

**Key Sections**:
- Phase 1: Analysis & Section Determination (AI analyzes input and plans structure)
- Phase 2: Progressive Specification Creation (AI creates detailed sections)
- Phase 3: Cross-Section Validation (AI validates all sections integrate properly)

### 2. Script File
**Path**: `pmc/product/_tools/04c-generate-structured-spec-prompt.js`

Interactive Node.js script that:
1. Loads the template
2. Gets paths from user (unstructured input, structured output)
3. Replaces placeholders in template
4. Generates ready-to-use prompt file
5. Provides clear next steps

### 3. Generated Prompt Files
**Path**: `pmc/product/_mapping/[project]/_run-prompts/04c-build-structured-spec-prompt-[timestamp].md`

These are the customized prompts generated by the script, ready to copy/paste into Claude.

---

## Quick Start Guide

### Step 1: Run the Script

```bash
cd pmc/product/_tools
node 04c-generate-structured-spec-prompt.js
```

### Step 2: Provide Paths

The script will ask for two paths:

**Unstructured Specification Input**:
- This is your source document (can be ANY format)
- Example: `../mapping/pipeline/iteration-8-LoRA-pipeline-figma-conversion.md`
- Must exist

**Structured Specification Output**:
- Where Claude will save the structured version
- Example: `../product/lora-training-structured-spec.md`
- Can be new file

### Step 3: Review Generated Prompt

The script saves a prompt file to:
```
pmc/product/_mapping/[project]/_run-prompts/04c-build-structured-spec-prompt-[timestamp].md
```

### Step 4: Use Prompt in Claude

1. Open the generated prompt file
2. Copy ENTIRE contents
3. Paste into Claude Sonnet 4.5 (200k context window)
4. Wait for Claude to analyze and create structured spec
5. Save Claude's output to the path you specified in Step 2

### Step 5: Review Structured Spec

Verify the structured specification has:
- ✅ Clear section breakdown with rationale
- ✅ Each section explicitly references previous sections
- ✅ No duplicated functionality
- ✅ Wireframe-level UI detail
- ✅ Complete API specifications with integration points
- ✅ Database schemas showing relationships
- ✅ Cross-section integration matrix

---

## What Makes This Different

### Traditional Approach
```
Section 1: User Management
  - Login form
  - User profile
  - Settings

Section 2: Dashboard
  - Stats display
  - User info
  - Navigation
```

**Problems**:
- "User info" in Section 2 - is this the same as "User profile" in Section 1?
- How does Dashboard navigation connect to User Management?
- Lots of guesswork and potential duplication

### Progressive Structured Approach
```
Section 1: User Management Foundation
  - FR-1.1.1: Login Form Component
    - Component: `LoginForm`
    - API: `POST /api/auth/login`
    - Returns: `UserSession` (defined here)
  
  - FR-1.1.2: User Profile Display
    - Component: `UserProfile`
    - Uses: `UserSession` from FR-1.1.1
    - Displays: user.name, user.email, user.avatar

Section 2: Dashboard with User Context
  - Builds Upon: Section 1, FR-1.1.1 (UserSession), FR-1.1.2 (UserProfile)
  
  - FR-2.1.1: Dashboard Layout
    - Component: `DashboardLayout`
    - Integrates: `UserProfile` from Section 1, FR-1.1.2
    - Enhancement: Adds quick-stats summary to UserProfile display
    - NEW Component: `DashboardStats`
    - Data Source: `GET /api/dashboard/stats` (NEW in this section)
```

**Benefits**:
- Crystal clear what's reused vs what's new
- Explicit integration points
- No ambiguity about relationships
- Each section builds incrementally

---

## Use Cases

### 1. Large Unstructured Specification
**Input**: 3000+ line technical document with mixed architecture, APIs, UI descriptions
**Output**: 8-12 progressive sections, each building on previous work
**Time Saved**: 40+ hours of manual organization

### 2. Feature-Rich Application
**Input**: List of 50+ features with minimal structure
**Output**: Logical feature groupings with clear dependencies
**Time Saved**: Prevent weeks of refactoring due to poor initial structure

### 3. API-Heavy Backend
**Input**: 100+ API endpoints described informally
**Output**: Grouped by domain, showing data flow and dependencies
**Time Saved**: Eliminate duplicate endpoints and conflicting designs

### 4. Complex UI Application
**Input**: Wireframe descriptions without clear component hierarchy
**Output**: Component library with inheritance and composition clearly defined
**Time Saved**: Prevent component explosion and UI inconsistencies

---

## Advanced Usage

### Custom Section Types

The template supports different structuring approaches:

**User Flow Stages** (Default):
- Onboarding → Core Features → Advanced Features → Administration
- Best for: User-facing applications with clear user journeys

**Technical Layers**:
- Data Layer → Business Logic → API Layer → UI Layer
- Best for: Backend-heavy systems, API platforms

**Feature Modules**:
- Auth Module → Content Module → Analytics Module → Export Module
- Best for: Modular applications with distinct feature sets

**Chronological Phases**:
- Setup → Operation → Monitoring → Analysis → Reporting
- Best for: Workflow-based applications, pipelines

To influence section type, include hints in your unstructured specification:
- "This is a user journey from X to Y"
- "This system has 4 distinct modules"
- "This follows a 6-stage pipeline"

### Iterative Refinement

If the first pass doesn't produce optimal sections:

1. Review the "Section Structure Plan" in Claude's output
2. Provide feedback: "Section 3 is too large, split into 3a and 3b"
3. Claude can regenerate with adjusted structure
4. Iterate until structure is optimal

### Extending Existing Specs

To add features to an existing structured spec:

1. Use existing structured spec as "Section 1-N"
2. Add new unstructured features
3. Run prompt: "Continue from Section N, adding features X, Y, Z"
4. Claude extends progressively from your existing structure

---

## Validation Checklist

After receiving structured spec from Claude, validate:

### Structure Quality
- [ ] Section breakdown makes logical sense
- [ ] Each section delivers user value when completed
- [ ] Sections are roughly equal in complexity (3-8 hours each)
- [ ] Total sections between 4-12 (adjust if too many/few)

### Progressive Building
- [ ] Section 2+ explicitly lists "Builds Upon" with specifics
- [ ] All cross-references use exact names (backticks)
- [ ] No functionality appears in multiple sections
- [ ] Integration points are bi-directionally documented

### Technical Completeness
- [ ] All UI components have wireframe-level detail
- [ ] All APIs have complete request/response schemas
- [ ] All database tables have complete definitions
- [ ] All TypeScript interfaces are defined

### Implementation Readiness
- [ ] Each section has clear acceptance criteria
- [ ] Dependencies are properly ordered
- [ ] Time estimates are realistic
- [ ] Testing strategy is defined

---

## Troubleshooting

### "Script can't find template"
**Problem**: `04c-build-structured-with-wirframe-spec_v1.md` not found
**Solution**: Ensure file exists in `pmc/product/_prompt_engineering/`

### "Unstructured spec file not found"
**Problem**: Path to input file is incorrect
**Solution**: Use relative paths from `pmc/product/_tools/` or absolute Windows paths

### "Claude's output is too vague"
**Problem**: Sections lack detail or explicit integration
**Solution**: Ask Claude: "Expand Section [N] with more specific component names, exact API endpoints, and explicit references to previous sections"

### "Too many/few sections created"
**Problem**: Claude created 15 sections or only 2 sections
**Solution**: Guide Claude: "Reorganize into 6-8 sections, combining [A+B] and splitting [C] into [C1+C2]"

### "Sections have duplicate functionality"
**Problem**: Same feature appears in multiple sections
**Solution**: Ask Claude: "Remove duplication between Section [X] and Section [Y], keep in Section [X] only and reference it in Section [Y]"

---

## Examples

### Example 1: LoRA Training Platform

**Input**: `iteration-8-LoRA-pipeline-figma-conversion.md` (3300 lines, unstructured)

**Output Structure** (determined by AI):
1. Section 1: Foundation & Authentication
2. Section 2: Dataset Management
3. Section 3: Training Configuration
4. Section 4: Training Execution & Monitoring
5. Section 5: Model Artifacts & Deployment
6. Section 6: System Integration & Testing

**Key Progressive Elements**:
- Section 2 uses `AuthContext` from Section 1
- Section 3 uses `DatasetSelector` component from Section 2
- Section 3 calls `GET /api/datasets/:id` from Section 2
- Section 4 uses `TrainingConfig` interface from Section 3
- Section 5 uses `ModelArtifact` type defined in Section 4's completion webhook

**Result**: Clear implementation path with zero ambiguity about dependencies

---

## Best Practices

### For Input Specifications

**DO**:
- ✅ Include all features you want in final system
- ✅ Mention user journeys if application is user-facing
- ✅ List all required technologies and integrations
- ✅ Include any existing code/APIs that must be integrated

**DON'T**:
- ❌ Pre-organize into sections (let AI determine optimal structure)
- ❌ Worry about order or grouping
- ❌ Duplicate information for emphasis
- ❌ Use vague terms ("handle data", "process requests")

### For Output Specifications

**DO**:
- ✅ Validate progressive building (each section references previous)
- ✅ Check for exact names in cross-references (backticks)
- ✅ Verify UI detail is wireframe-ready
- ✅ Confirm APIs have complete schemas
- ✅ Test that section order makes sense for implementation

**DON'T**:
- ❌ Accept vague integration points ("uses data from previous section")
- ❌ Tolerate duplicate functionality across sections
- ❌ Skip validation of cross-section references
- ❌ Proceed with ambiguous technical specifications

---

## Support & Maintenance

### Updating the Template

If you need to modify the template:

1. Edit: `pmc/product/_prompt_engineering/04c-build-structured-with-wirframe-spec_v1.md`
2. Test with script: `node 04c-generate-structured-spec-prompt.js`
3. Verify generated prompts work correctly
4. Update version number in template header
5. Document changes in this README

### Extending the Script

The script can be enhanced to:
- Support multiple input specifications (merge multiple unstructured docs)
- Add validation of generated prompts before saving
- Provide templates for different project types
- Auto-detect project context from file paths

To modify: Edit `pmc/product/_tools/04c-generate-structured-spec-prompt.js`

---

## FAQ

**Q: Can I use this for non-technical specifications?**
A: Yes! Works for any structured content (business processes, documentation, workflows)

**Q: What if my unstructured spec is only 200 lines?**
A: No problem. AI will create appropriate number of sections (might be 3-4 instead of 8-10)

**Q: Can I use this with other AI models besides Claude?**
A: Template is model-agnostic, but Claude Sonnet 4.5's 200k context works best for large specs

**Q: How long does Claude take to process?**
A: Typically 3-10 minutes depending on input size and complexity

**Q: Can I re-run if I don't like the output?**
A: Yes! Provide feedback to Claude and ask for restructuring

**Q: What if I want to add features later?**
A: Use existing structured spec as foundation, add new unstructured content, ask Claude to extend

---

## Version History

**v1.0** (Current)
- Initial release
- Support for unstructured → progressive structured transformation
- Automatic section determination
- Explicit cross-section integration
- Wireframe-level UI specifications
- Complete API and database schemas
- Interactive script with path validation

---

## License

Internal tool for BrightHub/BRun project use.

---

## Contact

For questions or issues with this system, contact the project lead or create an issue in the project repository.
